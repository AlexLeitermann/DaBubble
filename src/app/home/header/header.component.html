<div class="header-wrapper">
    <!-- <app-animation-intro [pause]="introService.awaitingAppInit" (then)="introService.onAnimationComplete()" *ngIf="!introService.afterAnimationPlusTimeout" />
    <a href="" class="logo-wrapper" [ngClass]="{'transparent': !introService.afterAnimation}">
        <img src="/assets/img/logo_name.svg" alt="DABubble" class="logo">
    </a> -->
    <a href="" class="logo-wrapper">
        <img src="/assets/img/logo_name.svg" alt="DABubble" class="logo">
    </a>
    <form class="searchbar-wrapper" #searchForm="ngForm">
        <div class="searchbar-box">
            <input #searchbar name="searchbar" [(ngModel)]="searchInput" type="text" placeholder="Devspace durchsuchen"
                autocomplete="off" (keyup)="search()">
            @if(searchInput.length > 0) {
            <button type="button" class="searchbar-icon material-icons-outlined"
                (click)="onCloseSearchClick()">close</button>
            <div class="search-results-container"
                *ngIf="searchResultsChannels.length + searchResultsUsers.length + searchResultsPosts.length > 0">

                <div class="search-results-list-container">
                    <p class="search-results-title first-title">
                        <span class="material-icons-outlined">workspaces</span>
                        Channels
                    </p>
                    <ul class="search-results-list" *ngIf="searchResultsChannels.length > 0"
                        [ngClass]="{'height-default': true}">
                        @for(channel of searchResultsChannels; track channel) {
                        <li># {{ channel.name }}</li>
                        }
                    </ul>
                </div>
                <div class="search-results-list-container">
                    <p class="search-results-title">
                        <span class="material-icons-outlined">account_circle</span>  
                        Nutzer
                    </p>
                    <ul class="search-results-list" *ngIf="searchResultsUsers.length > 0"
                        [ngClass]="{'height-default': true}">
                        @for(user of searchResultsUsers; track user) {
                        <li>&#0064;{{ user.name }}</li>
                        }
                    </ul>
                </div>
                <div class="search-results-list-container">
                    <p class="search-results-title">
                        <span class="material-icons-outlined">insert_comment</span>
                        Posts
                    </p>
                    <ul class="search-results-list" *ngIf="searchResultsPosts.length > 0"
                        [ngClass]="{'height-default': true}">
                        @for(post of searchResultsPosts; track post) {
                        <li>{{ post.message }}</li>
                        }
                    </ul>
                </div>
            </div>
            } @else {
            <button type="button" class="searchbar-icon material-icons-outlined"
                (click)="autofocusSearch()">search</button>
            }
        </div>
    </form>
    <div class="userprofile-wrapper" (click)="openUserLogoutCard()">
        <span class="userprofile-name">{{ mainUser.name || '...' }}</span>
        <div class="userprofile-image-box">
            <img src="{{ mainUser.avatarSrc || '/assets/img/avatar/empty_avatar.svg' }}">
            <div class="onlinedot" [ngClass]="{'online': activityService.getUserState(mainUser).state == 'active'}"
                [ngClass]="{'idle': activityService.getUserState(mainUser).state == 'idle'}"
                [ngClass]="{'offline': activityService.getUserState(mainUser).state == 'loggedOut'}"></div>
        </div>
        <div class="userprofile-menu-box">
            <img src="/assets/img/icons/dropdown_arrow.svg">
        </div>
    </div>
</div>