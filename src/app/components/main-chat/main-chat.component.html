<div class="main-container">
    <section class="main-section">
        <div class="main-header">
            <button class="channel-btn" (click)="onEditChannel()">
                <span class="channel-btn-name"># {{ currentChannel.name }}</span>
                <span class="material-icons-outlined icon">keyboard_arrow_down</span>
            </button>
            <div class="main-header-members">
                <button class="members-btn" (click)="openMemberList()">
                    <div class="m-images-container">
                        @for (member of currentChannel.members; track $index) {
                        @if ($index < 3) { <img src="{{getUserFromMembers(member.uid).avatarSrc}}" alt="Avatar">
                            }
                            }
                    </div>
                    <span>{{currentChannel.members.length}}</span>
                </button>
                <button class="add-members-btn" (click)="openAddMembers()">
                    <span class="material-icons-outlined icon">person_add_alt</span>
                </button>
            </div>
        </div>
        <div class="message-items-container">
            @if(currentChannel && currentChannel.posts.length > 0 && !currentChannel.isPmChannel) {
            @for (post of currentChannel.posts; track post.post_id; let i = $index) {
            <div class="message-item-container">
                <app-time-separator [timestamp]="post.date" />
                <app-message-item [post]="post" [messageSender]="isCurrentUserAuthor(i)" [postUid]="getPostUid(i)"
                    (threadId)="handleThread($event)" />
            </div>
            }
            } @else {
            <div class="create-channel-message-container">
                <h3>
                    <span>#</span>
                    {{ currentChannel.name }}
                </h3>
                <p>
                    Du hast diesen Channel {{ timeService.getRelativeDay(0) }} erstellt. Das ist der Anfang des Channels
                    <span># {{ currentChannel.name }}.</span>
                </p>
            </div>
            }
        </div>
        <app-message-box [channelName]="currentChannel.name" (sent)="onCreatePost($event)" />
    </section>
    <app-thread class="thread" *ngIf="openTh" (closeTh)="closeThread($event)" [post]="currPost"
        [channelData]="{ id: this.currentChannel.channel_id, name: this.currentChannel.name }" />
</div>